# MV进度条问题解决方案

## 问题描述
MV视频无法拖动进度条，通常是因为视频文件缺少关键帧信息或元数据不完整。

## 解决方案

### 1. 代码修改（已完成）
已经修改了 `play/templates/play.html` 中的MV播放代码：
- 添加了 `preload="metadata"` 属性
- 增加了视频加载事件监听
- 添加了错误处理和加载提示
- 设置了 `crossOrigin="anonymous"` 属性

### 2. 检查视频文件
运行检查脚本：
```bash
python check_video_files.py
```

这个脚本会：
- 检查所有MV文件的状态
- 显示文件大小、时长、分辨率等信息
- 识别有问题的视频文件
- 提供修复建议

### 3. 常见问题及解决方法

#### 问题1：视频文件损坏
**症状**：文件大小异常小或无法播放
**解决**：重新下载或获取完整的视频文件

#### 问题2：编码格式不兼容
**症状**：可以播放但无法拖动进度条
**解决**：使用ffmpeg重新编码

#### 问题3：缺少元数据
**症状**：视频时长显示为0或未知
**解决**：重新编码视频文件

### 4. 使用ffmpeg修复视频

如果安装了ffmpeg，可以使用以下命令修复视频：

```bash
# 基本修复命令
ffmpeg -i input.mp4 -c:v libx264 -c:a aac -movflags +faststart output.mp4

# 针对进度条问题的优化命令
ffmpeg -i input.mp4 -c:v libx264 -preset medium -crf 23 -c:a aac -b:a 128k -movflags +faststart -g 30 -keyint_min 30 output.mp4
```

参数说明：
- `-c:v libx264`: 使用H.264视频编码
- `-c:a aac`: 使用AAC音频编码
- `-movflags +faststart`: 优化网络播放
- `-g 30`: 设置关键帧间隔
- `-keyint_min 30`: 设置最小关键帧间隔

### 5. 手动检查步骤

1. **检查文件大小**：确保视频文件足够大（通常>1MB）
2. **检查文件格式**：确保是MP4格式
3. **检查浏览器控制台**：查看是否有错误信息
4. **测试不同浏览器**：确认是否是浏览器兼容性问题

### 6. 浏览器兼容性

不同浏览器对视频格式的支持：
- **Chrome/Edge**: 支持H.264 + AAC
- **Firefox**: 支持H.264 + AAC
- **Safari**: 支持H.264 + AAC
- **移动浏览器**: 通常支持H.264 + AAC

### 7. 调试信息

修改后的代码会在浏览器控制台输出调试信息：
- 视频加载状态
- 元数据加载情况
- 错误信息

打开浏览器开发者工具（F12）查看控制台输出。

### 8. 临时解决方案

如果问题仍然存在，可以尝试：
1. 使用不同的视频播放器库（如Video.js）
2. 将视频转换为WebM格式
3. 使用在线视频托管服务

## 测试步骤

1. 运行检查脚本：`python check_video_files.py`
2. 启动Django服务器
3. 访问AlwaysOnline播放页面
4. 点击MV按钮
5. 检查进度条是否可以拖动
6. 查看浏览器控制台的调试信息

## 注意事项

- 确保视频文件完整且未损坏
- 视频文件应该有正确的元数据
- 浏览器需要支持HTML5视频播放
- 某些浏览器可能需要用户交互才能播放视频 